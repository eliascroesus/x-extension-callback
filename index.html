<!DOCTYPE html>
<html>
<head>
    <title>X Extension Callback</title>
</head>
<body>
    <h1>Authorization Complete</h1>
    <p>Processing authentication...</p>
    <script>
        window.onload = function() {
            try {
                // Get the current URL including query parameters
                const currentUrl = window.location.href;
                console.log('Callback URL received:', currentUrl);
                
                // Send message to extension
                chrome.runtime.sendMessage('mfabfdnimhcpnkfkfpmdhcpfcgijadkb', {
                    type: 'oauth-callback',
                    payload: currentUrl
                }, function(response) {
                    if (response && response.success) {
                        document.body.innerHTML = '<h1>Authorization Complete</h1><p>You can close this window now.</p>';
                    } else {
                        document.body.innerHTML = '<h1>Authorization Failed</h1><p>Please try again.</p>';
                    }
                    // Close the window after a short delay
                    setTimeout(() => window.close(), 2000);
                });
            } catch (error) {
                document.body.innerHTML = '<h1>Error</h1><p>Failed to process authentication. Please try again.</p>';
                console.error('Callback error:', error);
            }
        };
    </script>
</body>
</html> 
